<sequence version="3.10"><group name="/Remove-OSUninstall" description="Remove the ability to roll back if Windows Setup completed successfully. Checks _SMSTSOSUpgradeActionReturnCode before running to ensure upgrade has completed."><condition><expression type="SMS_TaskSequence_VariableConditionExpression"><variable name="Operator">equals</variable><variable name="Value">0</variable><variable name="Variable">_SMSTSOSUpgradeActionReturnCode</variable></expression></condition><step type="SMS_TaskSequence_RunCommandLineAction" name="Set /Remove-OSUninstall" description="Remove the ability to roll back a PC to the previous installation of Windows" runIn="WinPEandFullOS" successCodeList="0 3010" retryCount="0" runFromNet="false"><action>smsswd.exe /run: cmd /c DISM /Online /Remove-OSUninstall</action><defaultVarList><variable name="CommandLine" property="CommandLine" hidden="true">cmd /c DISM /Online /Remove-OSUninstall</variable><variable name="SMSTSDisableWow64Redirection" property="DisableWow64Redirection">false</variable><variable name="_SMSTSRunCommandLineAsUser" property="RunAsUser">false</variable><variable name="SuccessCodes" property="SuccessCodes" hidden="true">0 3010</variable></defaultVarList></step></group><group name="/Set-OSUninstallWindow" description="Set the time limit in days for rollback if Windows Setup completed successfully. Checks _SMSTSOSUpgradeActionReturnCode before running to ensure upgrade has completed."><step type="SMS_TaskSequence_RunCommandLineAction" name="/Set-OSUninstallWindow" description="/Set-OSUninstallWindow /Value:&lt;days&gt; - change the days value as needed" runIn="WinPEandFullOS" successCodeList="0 3010" retryCount="0" runFromNet="false"><action>smsswd.exe /run: DISM /Online /Set-OSUninstallWindow /Value:10</action><defaultVarList><variable name="CommandLine" property="CommandLine" hidden="true">DISM /Online /Set-OSUninstallWindow /Value:10</variable><variable name="SMSTSDisableWow64Redirection" property="DisableWow64Redirection">false</variable><variable name="_SMSTSRunCommandLineAsUser" property="RunAsUser">false</variable><variable name="SuccessCodes" property="SuccessCodes" hidden="true">0 3010</variable></defaultVarList></step></group></sequence>
